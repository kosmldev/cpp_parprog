# Анализ производительности LU-разложения на C++

В данном репозитории представлена программа на C++, предназначенная для анализа производительности LU-разложения:

1. Нативное LU-разложение с использованием циклов.
2. LU-разложение с использованием библиотеки LAPACK.

Программа расположена по пути [`src/main.cpp`](https://github.com/kosmldev/cpp_parprog/blob/main/src/main.cpp).

## Запуск программы

Для билда образа воспользуйтесь файлом [`Dockerfile`](https://github.com/kosmldev/cpp_parprog/blob/main/Dockerfile):

```bash
docker build -t parallel .
```

Переменные окружения:
```
RUN_ONLY_LAPACK=1 // 1 - запуск только LAPACK, 0 - и LAPACK и нативный
SET_THREADS=8 // Количество тредов OpenBLAS
SET_SIZES=10 // Сетка размеров матрицы. 1 - {4}, 2 - {4, 8}, n - {4, 8, ..., 4*2^(n-1)}
SET_ITERATIONS=3 // Количество итераций на одном размере матрицы
```
Для запуска:

```bash
docker run --env RUN_ONLY_LAPACK=1 --env SET_THREADS=8 --env SET_SIZES=10 --env SET_ITERATIONS=3 --rm parallel
```

Этот процесс соберет образ `latest gcc`, установит необходимые библиотеки и запустит компилятор. В консоли будет отображен ход выполнения программы, а в конце будет представлена таблица с семью столбцами (или с четырьмя, если запускается только LAPACK):
1. Размер матрицы
2. Минимальное время расчета для нативного LU разложения
3. Минимальное время расчета для LAPACK LU разложения
4. Среднее время расчета для нативного LU разложения
5. Среднее время расчета для LAPACK LU разложения
6. Максимальное время расчета для нативного LU разложения
7. Максимальное время расчета для LAPACK LU разложения

## Краткое описание [`main.cpp`](https://github.com/kosmldev/cpp_parprog/blob/main/src/main.cpp)

### Функции
1. Генерация матрицы с рандомными величинами от -1 до +1 со стороной `n`.
2. Нативное LU разложение через циклы.
3. Замер времени нативного LU разложения.
4. LU разложение через LAPACK.
5. Замер времени LAPACK LU разложения.
6. Преобразование `n x n` матрицы в одномерный массив, пригодный для LAPACK LU разложения.
7. Функция для красивого вывода таблицы с результатами.

### Ход выполнения программы
1. Инициализация исходных данных.
2. Расчет и замер нативного LU разложения. (или шаг может быть отключен при RUN_ONLY_LAPACK=0)
3. Расчет и замер LAPACK LU разложения.
4. Вывод таблицы с результатами.


## Ознакомиться с поулченными результатами

Результаты моих запусков расположены в [`conclusion`](https://github.com/kosmldev/cpp_parprog/blob/main/conclusion)
Оформленный в единый отчет - [`conclusion/results.md`](https://github.com/kosmldev/cpp_parprog/blob/main/conclusion/results.md)
